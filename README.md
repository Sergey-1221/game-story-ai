# AI Game Story Generator

–ú–æ—â–Ω–∞—è AI-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤ –∏ —Å—é–∂–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è. –¢–µ–ø–µ—Ä—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ–¥—Ö–æ–¥–æ–≤ **Story2Game** –∏ **SceneCraft** –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏!

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **üé® –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π UI –Ω–∞ Streamlit –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- **üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤** –∏–∑ –∫—Ä–∞—Ç–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è
- **üîÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —Å—é–∂–µ—Ç–æ–≤** —Å —Ä–∞–∑–≤–∏–ª–∫–∞–º–∏ –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
- **üß† RAG (Retrieval-Augmented Generation)** –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∂–∞–Ω—Ä–æ–≤—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
- **‚ö° Story2Game –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
- **üé≠ SceneCraft –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 3D-–º–∞–∫–µ—Ç–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å—Ü–µ–Ω
- **üèóÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WFC, –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ ML
- **üéÆ –≠–∫—Å–ø–æ—Ä—Ç –≤ –∏–≥—Ä–æ–≤—ã–µ –¥–≤–∏–∂–∫–∏** - Unity, Unreal Engine
- **üîÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** - —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞
- **üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏** - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏** –∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–≥—Ä–æ–≤—ã—Ö –∂–∞–Ω—Ä–æ–≤

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π:

### –ë–∞–∑–æ–≤—ã–µ –º–æ–¥—É–ª–∏:
1. **Input Parser** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏—è
2. **Knowledge Base & RAG** - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∏ —Å–∏—Å—Ç–µ–º–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
3. **Story Planner** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–≤–µ—Å—Ç–∞ –∏ —Å—é–∂–µ—Ç–Ω—ã—Ö –≤–µ—Ç–æ–∫
4. **Scene Generator** - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π —Å—Ü–µ–Ω —Å –ø–æ–º–æ—â—å—é LLM
5. **Branch Manager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç–≤–ª–µ–Ω–∏—è–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
6. **Output Formatter** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã–≤–æ–¥ –≤ JSON

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:
7. **Story2Game Engine** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
8. **SceneCraft Visualizer** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 3D-–º–∞–∫–µ—Ç–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ü–µ–Ω
9. **Level Generator** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π (WFC, ML)
10. **Object Placement Engine** - –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
11. **Diffusion Visualizer** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Stable Diffusion
12. **Game Engine Exporters** - —ç–∫—Å–ø–æ—Ä—Ç –≤ Unity –∏ Unreal Engine

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/yourusername/game-story-ai.git
cd game-story-ai

# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –°–∫–∞—á–∞—Ç—å —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
python -m spacy download ru_core_news_sm
python -m spacy download en_core_web_sm
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
OPENAI_API_KEY=your_openai_api_key_here
ANTHROPIC_API_KEY=your_anthropic_api_key_here  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
CHROMA_PERSIST_DIRECTORY=./data/chroma
LOG_LEVEL=INFO
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π, –ø–æ–º–µ—Å—Ç–∏–≤ —Ñ–∞–π–ª—ã –∂–∞–Ω—Ä–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –≤ `data/knowledge_base/`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üé® –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# Windows
run_ui.bat

# Linux/Mac
./run_ui.sh

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
streamlit run streamlit_app.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8501 –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É UI.

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ)

```python
from src.quest_generator import QuestGenerator

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
generator = QuestGenerator()

# –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
scenario = {
    "genre": "–∫–∏–±–µ—Ä–ø–∞–Ω–∫",
    "hero": "—Ö–∞–∫–µ—Ä-–æ–¥–∏–Ω–æ—á–∫–∞",
    "goal": "–≤–∑–ª–æ–º–∞—Ç—å –∑–∞–º–æ–∫ –Ω–∞ –¥–≤–µ—Ä–∏, –Ω–∞–π—Ç–∏ –∏ –∑–∞–±—Ä–∞—Ç—å —á–∏–ø —Å –≤–∏—Ä—É—Å–æ–º"
}

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–≤–µ—Å—Ç–∞
quest = generator.generate(scenario)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
generator.save_quest(quest, "quest.json")
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å Story2Game –∏ SceneCraft

```python
from src.modules.integrated_quest_generator import IntegratedQuestGenerator

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
generator = IntegratedQuestGenerator()

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –ª–æ–≥–∏–∫–æ–π –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
result = await generator.generate_enhanced_quest(
    scenario,
    with_logic=True,      # Story2Game –ª–æ–≥–∏–∫–∞
    with_visuals=True,    # SceneCraft –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    export_code=True      # –≠–∫—Å–ø–æ—Ä—Ç –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞
generator.save_enhanced_quest(result, "output/enhanced_quest")
```

### CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
python main.py --input scenario.txt --output quest.json
```

### API —Å–µ—Ä–≤–µ—Ä

```bash
# –ó–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–µ—Ä–∞
uvicorn src.api.main:app --reload

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ API
curl -X POST http://localhost:8000/generate \
  -H "Content-Type: application/json" \
  -d '{"genre": "fantasy", "hero": "knight", "goal": "save princess"}'
```

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- **–ñ–∞–Ω—Ä**: –Ω–∞–ø—Ä–∏–º–µ—Ä, "–∫–∏–±–µ—Ä–ø–∞–Ω–∫", "—Ñ—ç–Ω—Ç–µ–∑–∏", "–¥–µ—Ç–µ–∫—Ç–∏–≤"
- **–ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π**: –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ç–∞–≥–æ–Ω–∏—Å—Ç–∞
- **–¶–µ–ª—å**: –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –∫–≤–µ—Å—Ç–∞

–ü—Ä–∏–º–µ—Ä `scenario.txt`:
```
–ñ–∞–Ω—Ä: –∫–∏–±–µ—Ä–ø–∞–Ω–∫
–ì–µ—Ä–æ–π: —Ö–∞–∫–µ—Ä-–æ–¥–∏–Ω–æ—á–∫–∞
–¶–µ–ª—å: –≤–∑–ª–æ–º–∞—Ç—å –∑–∞–º–æ–∫ –Ω–∞ –¥–≤–µ—Ä–∏, –Ω–∞–π—Ç–∏ –∏ –∑–∞–±—Ä–∞—Ç—å —á–∏–ø —Å –≤–∏—Ä—É—Å–æ–º
```

## –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–∞—Å—Å–∏–≤–æ–º —Å—Ü–µ–Ω:

```json
{
  "quest": {
    "title": "–ö—Ä–∞–∂–∞ –≤–∏—Ä—É—Å–Ω–æ–≥–æ —á–∏–ø–∞",
    "genre": "–∫–∏–±–µ—Ä–ø–∞–Ω–∫",
    "scenes": [
      {
        "scene_id": "scene_1",
        "text": "–¢—ã —Å—Ç–æ–∏—à—å –ø–µ—Ä–µ–¥ –º–∞—Å—Å–∏–≤–Ω–æ–π —Å—Ç–∞–ª—å–Ω–æ–π –¥–≤–µ—Ä—å—é...",
        "choices": [
          {
            "text": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∏–±–µ—Ä–¥–µ–∫—É –¥–ª—è –≤–∑–ª–æ–º–∞",
            "next_scene": "scene_2"
          },
          {
            "text": "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –Ω–∞–π—Ç–∏ –¥—Ä—É–≥–æ–π –≤—Ö–æ–¥",
            "next_scene": "scene_3"
          }
        ]
      }
    ]
  }
}
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∂–∞–Ω—Ä–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —à–∞–±–ª–æ–Ω–∞ –≤ `data/knowledge_base/genres/`
2. –î–æ–±–∞–≤—å—Ç–µ –∂–∞–Ω—Ä–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
3. –û–±–Ω–æ–≤–∏—Ç–µ embeddings –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π

```python
from src.extensions.image_generator import ImageGenerator

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Å—Ü–µ–Ω
image_gen = ImageGenerator()
for scene in quest.scenes:
    image_url = image_gen.generate_scene_image(scene.text)
    scene.image = image_url
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=src

# –¢–æ–ª—å–∫–æ —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
pytest tests/unit/

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/integration/
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª LICENSE

## –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è pull requests! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å CONTRIBUTING.md –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.