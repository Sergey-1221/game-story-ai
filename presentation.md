# AI Game Story Generator - Презентация проекта

## 1. Идея / цель проекта

### Основная концепция
Создание интеллектуальной системы для автоматической генерации интерактивных игровых квестов и сюжетов из текстовых описаний. Система использует современные технологии машинного обучения (LLM) и искусственного интеллекта для создания богатых, разветвленных нарративов с логической структурой и 3D-визуализацией.

### Цели проекта
- **Автоматизация создания контента**: Упростить процесс разработки игрового контента для геймдизайнеров и разработчиков
- **Интеллектуальная генерация**: Создавать не просто текст, а полноценные интерактивные квесты с логикой, предусловиями и последствиями действий
- **Мультимодальность**: Объединить текстовую генерацию с 3D-визуализацией и структурированной логикой
- **Адаптивность**: Поддержка различных жанров и стилей повествования
- **Интеграция**: Экспорт в популярные игровые движки (Unity, Unreal Engine)

### Решаемые проблемы
- Высокая стоимость и время создания игрового контента
- Нехватка творческих идей у разработчиков
- Сложность создания разветвленных сюжетов с множественными концовками
- Необходимость визуализации сценариев на раннем этапе разработки

## 2. Особенности проекта

### Ключевые возможности

#### Интеллектуальная генерация
- **RAG-система**: Использование базы знаний с жанровой информацией для контекстно-зависимой генерации
- **Многоуровневая структура**: Создание квестов с несколькими уровнями вложенности и ветвления
- **Адаптивное планирование**: Динамическое создание структуры квеста на основе пользовательского ввода

#### Story2Game интеграция
- **Структурированная логика**: Автоматическое добавление предусловий и эффектов к игровым действиям
- **Управление состоянием мира**: Отслеживание объектов, локаций, инвентаря игрока
- **Валидация действий**: Проверка корректности последовательности игровых событий

#### SceneCraft визуализация
- **3D-макеты сцен**: Автоматическая генерация трехмерных планировок локаций
- **Композитные изображения**: Создание визуальных представлений сцен
- **Интерактивные карты**: Генерация общих карт квестов с связями между локациями

#### Мультиформатный вывод
- **JSON-структуры**: Базовые и расширенные форматы квестов
- **Исполняемый код**: Экспорт в Python/JavaScript для прямого использования
- **Игровые движки**: Адаптированные форматы для Unity и Unreal Engine
- **Визуальные материалы**: Изображения, схемы, 3D-модели

### Технологические особенности

#### Архитектурная гибкость
- **Модульная система**: Каждый компонент может использоваться независимо
- **Асинхронная обработка**: Поддержка параллельной генерации различных компонентов
- **Конфигурируемость**: Гибкая настройка параметров генерации

#### Поддержка различных LLM
- OpenAI GPT (GPT-4, GPT-4o, GPT-4o-mini)
- Anthropic Claude (опционально)
- Возможность добавления других моделей

#### Векторная база данных
- ChromaDB для хранения и поиска жанровой информации
- Семантический поиск по контексту
- Персистентное хранение данных

## 3. Архитектура / реализация

### Общая архитектура системы

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Пользователь  │────│  Streamlit UI /  │────│   API Server    │
│                 │    │   CLI Interface  │    │   (FastAPI)     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                │                        │
                                └────────────────────────┘
                                         │
                        ┌────────────────────────────────┐
                        │      QuestGenerator            │
                        │   (Основной оркестратор)       │
                        └────────────────────────────────┘
                                         │
        ┌────────────────────────────────┼────────────────────────────────┐
        │                                │                                │
┌───────────────┐             ┌─────────────────┐              ┌──────────────────┐
│ InputParser   │             │ KnowledgeBase   │              │ IntegratedQuest  │
│ (Обработка    │             │ (RAG + ChromaDB)│              │ Generator        │
│ входных       │             │                 │              │ (Story2Game +    │
│ данных)       │             │                 │              │ SceneCraft)      │
└───────────────┘             └─────────────────┘              └──────────────────┘
        │                                │                                │
        └────────────────┐               │               ┌────────────────┘
                         │               │               │
              ┌──────────────────────────┼───────────────────────────┐
              │                          │                           │
    ┌─────────────────┐      ┌──────────────────┐        ┌─────────────────┐
    │ StoryPlanner    │      │ SceneGenerator   │        │ BranchManager   │
    │ (Планирование   │      │ (Генерация       │        │ (Управление     │
    │ структуры       │      │ сцен)            │        │ ветвлениями)    │
    │ квеста)         │      │                  │        │                 │
    └─────────────────┘      └──────────────────┘        └─────────────────┘
              │                          │                           │
              └──────────────────────────┼───────────────────────────┘
                                         │
                              ┌──────────────────┐
                              │ OutputFormatter  │
                              │ (Форматирование  │
                              │ результата)      │
                              └──────────────────┘
```

### Слоистая архитектура

#### Core Layer (Ядро)
- **models.py**: Определение всех структур данных
  - `Quest`, `Scene`, `Choice`, `Action`
  - `WorldState`, `GameEntity`, `Location`
  - `GenerationConfig`, `QuestMetadata`

#### Module Layer (Модули)
- **InputParser**: Извлечение параметров из пользовательского ввода
- **KnowledgeBase**: RAG-система с векторным поиском
- **StoryPlanner**: Создание общей структуры квеста
- **SceneGenerator**: Генерация детализированных сцен
- **BranchManager**: Управление ветвлением сюжета
- **Story2GameEngine**: Добавление игровой логики
- **SceneCraftVisualizer**: 3D-визуализация сцен

#### Integration Layer (Интеграция)
- **QuestGenerator**: Базовый генератор квестов
- **IntegratedQuestGenerator**: Расширенный генератор с Story2Game и SceneCraft
- **HybridPipeline**: Продвинутая интеграция с различными стратегиями

#### API Layer (API)
- **FastAPI сервер**: RESTful API для веб-интеграции
- **Streamlit интерфейс**: Веб-UI для интерактивного использования

### Ключевые компоненты реализации

#### Управление состоянием
```python
class WorldState:
    """Отслеживание состояния игрового мира"""
    - entities: Dict[str, GameEntity]  # Игровые объекты
    - locations: Dict[str, Location]   # Локации
    - player_inventory: List[str]      # Инвентарь игрока
    - global_flags: Dict[str, bool]    # Глобальные флаги
```

#### Конфигурация генерации
```python
class GenerationConfig:
    """Настройки процесса генерации"""
    - model: str                    # Используемая LLM
    - temperature: float            # Творческий параметр
    - max_tokens: int              # Максимум токенов
    - enable_rag: bool             # Включить RAG
    - branching_depth: int         # Глубина ветвления
    - enable_visualization: bool    # Включить визуализацию
```

#### Пайплайн генерации
1. **Парсинг входных данных** → Извлечение жанра, героя, цели
2. **RAG-поиск** → Получение релевантного контекста из базы знаний
3. **Планирование структуры** → Создание общего плана квеста
4. **Генерация сцен** → Детализация каждой сцены с помощью LLM
5. **Добавление логики** → Story2Game добавляет предусловия/эффекты
6. **Визуализация** → SceneCraft создает 3D-макеты и изображения
7. **Валидация** → Проверка целостности квеста
8. **Форматирование** → Экспорт в требуемые форматы

### Технологический стек

#### Backend
- **Python 3.8+**: Основной язык разработки
- **FastAPI**: Веб-фреймворк для API
- **Pydantic**: Валидация данных и сериализация
- **ChromaDB**: Векторная база данных
- **OpenAI API**: Доступ к GPT моделям
- **spaCy**: Обработка естественного языка

#### Frontend/UI
- **Streamlit**: Веб-интерфейс для пользователей
- **HTML/CSS/JavaScript**: Кастомизация интерфейса

#### Data & Storage
- **JSON**: Основной формат данных
- **SQLite**: Локальное хранение (через ChromaDB)
- **File System**: Сохранение сгенерированных квестов

#### AI/ML
- **LangChain**: Фреймворк для работы с LLM
- **Transformers**: Для работы с эмбеддингами
- **NumPy/Pandas**: Обработка данных

## 4. Пользовательский сценарий

### Базовый сценарий использования

#### Шаг 1: Запуск интерфейса
```bash
# Активация виртуального окружения
venv\Scripts\activate

# Запуск Streamlit интерфейса
venv\Scripts\streamlit.exe run streamlit_app.py
```

#### Шаг 2: Создание квеста
1. **Ввод базовой информации**:
   - Жанр: "Киберпанк"
   - Герой: "Хакер-одиночка"
   - Цель: "Проникнуть в корпоративную сеть и украсть секретные данные"

2. **Настройка параметров генерации**:
   - Модель: GPT-4o-mini
   - Температура: 0.7 (баланс между креативностью и логичностью)
   - Глубина ветвления: 3 уровня
   - Включить визуализацию: Да
   - Использовать RAG: Да

#### Шаг 3: Процесс генерации
Система автоматически выполняет следующие шаги:

1. **Анализ входных данных** (5-10 сек)
   - Извлечение ключевых элементов
   - Определение контекста и стиля

2. **Поиск в базе знаний** (3-5 сек)
   - Семантический поиск по жанру "киберпанк"
   - Извлечение релевантных элементов (технологии, локации, персонажи)

3. **Планирование структуры** (10-15 сек)
   - Создание общего плана квеста
   - Определение ключевых точек и развилок

4. **Генерация сцен** (30-60 сек)
   - Детализация каждой сцены
   - Создание диалогов и описаний
   - Генерация вариантов выбора

5. **Добавление игровой логики** (15-20 сек)
   - Story2Game анализирует сцены
   - Добавляет предусловия для действий
   - Определяет эффекты от выборов игрока

6. **Создание визуализации** (20-30 сек)
   - SceneCraft генерирует 3D-макеты локаций
   - Создает композитные изображения сцен
   - Формирует общую карту квеста

#### Шаг 4: Результат генерации

Пользователь получает:

**Основной квест "Цифровой взлом"**:
- 12 сцен с разветвленной структурой
- 3 возможные концовки
- 45 интерактивных выборов
- Логическая система с 20+ предусловиями

**Пример сцены**:
```json
{
  "id": "scene_corporate_lobby",
  "title": "Корпоративный вестибюль MegaCorp",
  "description": "Блестящий мраморный холл с голографическими проекциями...",
  "choices": [
    {
      "text": "Попытаться взломать систему безопасности",
      "preconditions": ["has_cyberdeck", "hacking_skill >= 3"],
      "effects": ["security_alert = true", "gain_access_card"]
    }
  ],
  "visualization": {
    "layout_3d": "scene_corporate_lobby/layout.json",
    "composite_image": "scene_corporate_lobby/composite.png"
  }
}
```

#### Шаг 5: Использование результатов

**Сохранение и экспорт**:
- Квест сохраняется в папку `saved_quests/`
- Доступны форматы: JSON, Python код, Unity prefab
- Созданы визуальные материалы для презентации

**Интеграция в игру**:
```python
# Пример использования сгенерированного кода
from saved_quests.digital_heist.quest_logic import DigitalHeistQuest

quest = DigitalHeistQuest()
current_scene = quest.start()
player_choice = quest.get_available_choices(current_scene)
next_scene = quest.process_choice(player_choice[0])
```

### Продвинутые сценарии использования

#### Разработчик игр
1. Создает несколько вариантов квеста с разными параметрами
2. Использует визуализации для презентации команде
3. Экспортирует логику в Unity для прототипирования
4. Итеративно улучшает квест на основе обратной связи

#### Геймдизайнер
1. Исследует различные жанры и стили повествования
2. Анализирует структуру сгенерированных квестов
3. Использует как источник вдохновения для собственных идей
4. Создает библиотеку шаблонов для будущих проектов

#### Инди-разработчик
1. Быстро создает контент для прототипа игры
2. Генерирует несколько квестов для тестирования механик
3. Использует визуализации для поиска финансирования
4. Экспортирует готовый код для интеграции в игру

### Метрики успешности

После использования системы пользователи получают:
- **Скорость**: Создание квеста за 2-5 минут вместо часов ручной работы
- **Качество**: Логически связанные сцены с проверенными предусловиями
- **Визуализация**: Готовые материалы для презентации и планирования
- **Гибкость**: Множество форматов экспорта для различных целей
- **Креативность**: Неожиданные сюжетные ходы и идеи от ИИ

---

*Система AI Game Story Generator представляет собой комплексное решение для автоматизации создания игрового контента, объединяющее современные технологии ИИ с практическими потребностями игровой индустрии.*